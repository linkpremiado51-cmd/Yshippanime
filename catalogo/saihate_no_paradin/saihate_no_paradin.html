<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="description" content="Assista seus animes favoritos no Anime I Geek">
    <title>Saihate no Paladin - Fanpage</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Jura:wght@300..700&family=Ubuntu:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
/* INÍCIO DO CSS UNIFICADO (Com Alterações Solicitadas) */
html {
    scroll-behavior: smooth;
    font-size: 16px;
}
:root {
    --primary-gradient: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
    --text-primary: #1a202c;
    --text-secondary: #4a5568;
    --background: #f5f7fa;
    --surface: rgba(0, 0, 0, 0.05);
    --border: rgba(0, 0, 0, 0.1);
    --shadow-color: rgba(0, 0, 0, 0.2);
    --blur-effect: blur(12px);
    --transition: all 0.6s ease-in-out;
    --highlight-color: #E53E3E;
    --highlight-hover: #C53030;
    --watch-later-color: #38A169;
    --watch-later-hover: #2F855A;
    --episodes-color: #2D3748;
    --episodes-hover: #4A5568;
    --report-error-color: #4B5563;
    --report-error-hover: #6B7280;
    --menu-background: rgba(255, 255, 255, 0.65);
    --menu-item-background: rgba(0, 0, 0, 0.05);
    --menu-item-hover-background: rgba(0, 0, 0, 0.1);
    --spacing-sm: 12px;
    --spacing-md: 20px;
    --spacing-section: 40px;
    --font-size-xs: clamp(0.8rem, 2vw, 1rem);
    --font-size-sm: clamp(1rem, 2.5vw, 1.1rem);
    --font-size-md: clamp(1.1rem, 3vw, 1.3rem);
    --font-size-lg: clamp(1.4rem, 4vw, 1.8rem);
    --primary: #2d3748;
    --shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    --shadow-lg: 0 4px 12px rgba(0, 0, 0, 0.15);
    --menu-bg-light: rgba(255, 255, 255, 0.5);
    --menu-bg-dark: rgba(45, 55, 72, 0.5);
    --card-bg: #ffffff;
    --card-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
    --header-bg: var(--surface);
    --progress-bg: #edf2f7;
    --zoom-scale: 1.0;
    --watch-now-button-width: 150px;
    --cover-button-opacity: 0.8;
}
[data-theme="dark"] {
    --text-primary: #e2e8f0;
    --text-secondary: #a0aec0;
    --background: #1a202c;
    --surface: rgba(255, 255, 255, 0.05);
    --border: #4a5568;
    --shadow-color: rgba(0, 0, 0, 0.4);
    --menu-background: rgba(45, 55, 72, 0.65);
    --menu-item-background: rgba(255, 255, 255, 0.05);
    --menu-item-hover-background: rgba(255, 255, 255, 0.1);
    --card-bg: #374151;
    --card-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
    --shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
    --shadow-lg: 0 4px 12px rgba(0, 0, 0, 0.4);
    --progress-bg: #4a5568;
}
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    user-select: text !important;
    -webkit-user-select: text !important;
}
body {
    font-family: 'Jura', sans-serif;
    font-weight: 400;
    line-height: 1.5;
    background: var(--background);
    color: var(--text-primary);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    overflow-x: hidden;
    transition: background 0.3s ease, color 0.3s ease;
    overscroll-behavior-x: none;
}
.zoom-container {
    width: 100%;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding-top: 0;
}
.header-menu {
    width: 100%;
}
.header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: 65px;
    background: var(--header-bg, var(--surface));
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 16px;
    z-index: 1001;
    box-shadow: var(--shadow);
    transition: background 0.3s ease;
}
.header h1 {
    font-size: 1.125rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--text-primary);
}
:fullscreen .header {
    display: none !important;
}
:-webkit-full-screen .header {
    display: none !important;
}
.top-bar__section {
    display: flex;
    align-items: center;
    gap: 12px;
}
.top-bar__icon {
    color: var(--text-primary);
    background: none;
    border: none;
    padding: 8px;
    cursor: pointer;
    transition: background 0.2s, color 0.2s;
    border-radius: 0px;
}
.top-bar__icon i {
    font-size: 1.125rem;
}
.top-bar__icon:hover {
    background: var(--primary);
    color: white;
}
.top-bar__icon:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}
/* NOVO: Menu Hamburguer (Renderizado no próprio código) */
.hamburger-menu {
    position: fixed;
    top: 0;
    right: -300px;
    width: 280px;
    max-width: 80%;
    height: 100%;
    background: var(--menu-background);
    backdrop-filter: var(--blur-effect);
    z-index: 4000;
    transition: right 0.3s ease-in-out;
    box-shadow: -4px 0 12px var(--shadow-color);
    padding: 65px 20px 20px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}
.hamburger-menu.open {
    right: 0;
}
.menu-item {
    padding: 15px;
    margin-bottom: 8px;
    background: var(--menu-item-background);
    color: var(--text-primary);
    text-decoration: none;
    font-size: 1rem;
    font-weight: 500;
    border-radius: 0px;
    transition: background 0.2s ease;
    display: flex;
    align-items: center;
    gap: 10px;
}
.menu-item:hover {
    background: var(--menu-item-hover-background);
}
.menu-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 3999;
    display: none;
}
.menu-overlay.active {
    display: block;
}
.menu {
    position: fixed;
    top: 65px;
    left: 0;
    right: 0;
    width: 100%;
    height: 50vh;
    background: var(--menu-bg-light);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border);
    box-shadow: var(--shadow-lg);
    transform: translateY(-100%);
    transition: transform 0.4s ease;
    z-index: 1000;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px 16px;
    opacity: 0;
    pointer-events: none;
}
[data-theme="dark"] .menu {
    background: var(--menu-bg-dark);
}
.menu.open {
    transform: translateY(0);
    opacity: 1;
    pointer-events: auto;
}
.search-container {
    width: 100%;
    max-width: 600px;
    position: relative;
    margin-bottom: 16px;
}
.search-input {
    width: 100%;
    padding: 14px 50px 14px 16px;
    font-size: 1rem;
    border: 1px solid var(--border);
    border-radius: 0px;
    background: var(--surface);
    color: var(--text-primary);
    outline: none;
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}
.search-input:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(45, 55, 72, 0.1);
}
.search-icon {
    position: absolute;
    right: 16px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-secondary);
    font-size: 1.1rem;
    pointer-events: none;
}
.result-card {
    width: 100%;
    max-width: 600px;
    background: var(--card-bg);
    border-radius: 0px;
    padding: 20px;
    box-shadow: var(--card-shadow);
    display: none;
    flex-direction: column;
    gap: 12px;
    opacity: 0;
    transform: translateY(-10px);
    transition: all 0.4s ease;
    margin-top: 8px;
}
.result-card.show {
    opacity: 1;
    transform: translateY(0);
    display: flex;
}
.result-suggestion-item {
    display: flex;
    align-items: center;
    padding: 10px 12px;
    border-radius: 0px;
    text-decoration: none;
    color: var(--text-primary);
    transition: background 0.2s ease;
    width: 100%;
}
.result-suggestion-item:hover {
    background: var(--menu-item-hover-background);
}
.result-suggestion-title {
    font-weight: 500;
    font-size: 0.95rem;
}
.notification {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    padding: 15px 30px;
    box-shadow: 0 4px 12px var(--shadow-color);
    opacity: 0;
    transition: opacity 0.3s ease;
    z-index: 2000;
    font-size: var(--font-size-md);
    font-weight: 500;
    text-align: center;
    max-width: 90%;
    width: 400px;
    border-radius: 0px;
}
[data-theme="light"] .notification {
    background: rgba(255, 255, 255, 0.95);
    color: var(--text-primary);
}
[data-theme="dark"] .notification {
    background: rgba(18, 21, 32, 0.95);
    color: var(--text-primary);
}
.notification.show {
    opacity: 1;
}
.footer {
    width: 100%;
    background: var(--surface);
    color: var(--text-secondary);
    text-align: center;
    padding: 16px 16px;
    margin-top: var(--spacing-section);
    box-shadow: 0 -2px 5px var(--shadow-color);
    font-size: var(--font-size-xs);
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
}
.footer-left {
    display: flex;
    align-items: center;
    gap: 8px;
}
.footer-right {
    text-align: right;
}
.footer a {
    color: var(--highlight-color);
    text-decoration: none;
    margin: 0 10px;
    transition: color 0.2s ease;
}
.footer a:hover {
    color: var(--highlight-hover);
}
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
.fade-in {
    animation: fadeIn 0.4s ease-out forwards;
}
@media (max-width: 768px) {
    :root {
        --spacing-section: 25px;
    }
    .header {
        padding: 0 12px;
        height: 55px;
    }
    .header h1 {
        font-size: 1rem;
    }
    .top-bar__icon i {
        font-size: 1rem;
    }
    .notification {
        font-size: var(--font-size-sm);
        padding: 10px 20px;
        width: 300px;
    }
    .zoom-container {
        padding-top: 0;
    }
    .menu {
        top: 55px;
    }
    .top-bar__icon {
        padding: 6px;
    }
    .footer {
        flex-direction: column;
        align-items: flex-start;
        padding-bottom: 70px;
    }
    .footer-left {
        width: 100%;
        margin-bottom: 10px;
        justify-content: center;
    }
    .footer-right {
        text-align: center;
        width: 100%;
    }
    /* Estilo do modal em telas menores */
    .modal-content {
        max-width: 95%;
        margin: 20px;
        padding: 20px;
        max-height: 90vh;
        overflow-y: auto;
    }
    .modal-main-content {
        flex-direction: column;
    }
    .modal-trailer-container {
        width: 100%;
        margin-right: 0;
        margin-bottom: 15px;
    }
    .modal-synopsis-container {
        width: 100%;
    }
}
@media (max-width: 480px) {
   /* Estilos mobile */
}
@media (min-width: 601px) and (max-width: 1024px) {
    .header h1 {
        font-size: 1.125rem;
    }
}
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    z-index: 5000;
    display: none;
    justify-content: center;
    align-items: center;
}
/* ✨ NOVO ESTILO DO MODAL DE DETALHES (Sinopse + Trailer / RPG Style) */
.modal-content {
    background: var(--card-bg); /* Fundo claro ou escuro do card */
    color: var(--text-primary);
    padding: 30px;
    border-radius: 0px;
    width: 90%;
    max-width: 800px; /* Aumenta a largura máxima para acomodar trailer */
    box-shadow: var(--shadow-lg);
    animation: fadeIn 0.3s ease-out;
    max-height: 90vh;
    overflow-y: auto; /* Permite scroll se o conteúdo for muito grande */
}
.modal-content h3 {
    font-size: var(--font-size-lg);
    font-weight: 700;
    margin-bottom: 20px;
    border-bottom: 2px solid var(--highlight-color);
    padding-bottom: 10px;
}
.modal-main-content {
    display: flex;
    gap: 20px;
}
/* ✨ Aumento de 30px na altura do frame do YouTube */
.modal-trailer-container {
    flex: 1;
    min-width: 300px;
    position: relative;
    padding-bottom: calc(56.25% + 30px); /* 16:9 Aspect Ratio + 30px */
    height: 0;
    overflow: hidden;
    background: #000;
}
.trailer-video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: none;
}
.modal-synopsis-container {
    flex: 1;
    max-height: 400px; /* Limita altura da sinopse no desktop */
    overflow-y: auto;
    padding-right: 10px;
}
.modal-synopsis-container p {
    font-size: var(--font-size-sm);
    line-height: 1.6;
    margin-bottom: 10px;
    color: var(--text-secondary);
}
/* Scrollbar customizada para Firefox */
.modal-synopsis-container {
    scrollbar-width: thin;
    scrollbar-color: var(--highlight-color) var(--surface);
}
/* Scrollbar customizada para Webkit */
.modal-synopsis-container::-webkit-scrollbar {
    width: 8px;
}
.modal-synopsis-container::-webkit-scrollbar-thumb {
    background-color: var(--highlight-color);
    border-radius: 4px;
}
.modal-synopsis-container::-webkit-scrollbar-track {
    background: var(--surface);
}
/* Estilo para o modal RPG (Personagem) */
.modal-rpg-content {
    display: flex;
    gap: 20px;
    align-items: flex-start;
}
.modal-rpg-image {
    flex-shrink: 0;
    width: 150px; /* <-- LARGURA DIMINUÍDA NO MODAL */
    height: 210px; /* <-- ALTURA DIMINUÍDA NO MODAL */
    background-size: cover;
    background-position: center;
    border-radius: 0px;
    box-shadow: var(--shadow-lg);
}
.modal-rpg-info {
    flex-grow: 1;
    padding: 10px 0;
}
.modal-rpg-info h4 {
    font-size: var(--font-size-md);
    font-weight: 600;
    margin-bottom: 10px;
    color: var(--text-primary);
}
.modal-rpg-info p {
    font-size: var(--font-size-sm);
    line-height: 1.6;
    color: var(--text-secondary);
}
/* Estilo para o modal de Descrição de Episódio */
.modal-episode-content {
    display: block;
}
.modal-episode-image {
    width: 100%;
    height: 200px; /* Altura fixa para a imagem do episódio */
    background-size: cover;
    background-position: center;
    border-radius: 0px;
    box-shadow: var(--shadow-lg);
    margin-bottom: 15px;
}
.modal-episode-info {
    padding: 0 10px;
}
.modal-episode-info h4 {
    font-size: var(--font-size-md);
    font-weight: 600;
    margin-bottom: 10px;
    color: var(--text-primary);
}
.modal-episode-info p {
    font-size: var(--font-size-sm);
    line-height: 1.6;
    color: var(--text-secondary);
}

/* Estilos do modal de Reportar (mantidos) */
.report-option {
    display: block;
    width: 100%;
    padding: 12px;
    margin-bottom: 10px;
    background: var(--menu-item-background);
    border: 1px solid var(--border);
    border-radius: 0px;
    text-align: left;
    cursor: pointer;
    transition: background 0.2s;
    font-size: var(--font-size-sm);
    display: flex;
    align-items: center;
    gap: 10px;
}
.report-option:hover {
    background: var(--menu-item-hover-background);
}
.modal-close-btn {
    display: block;
    width: 100%;
    padding: 10px;
    margin-top: 20px;
    background: var(--highlight-color);
    color: white;
    border: none;
    border-radius: 0px;
    cursor: pointer;
    font-weight: bold;
    transition: background 0.2s;
}
.modal-close-btn:hover {
    background: var(--highlight-hover);
}
.fixed-footer-controls {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: 50px;
    background: var(--header-bg, var(--surface));
    border-top: 1px solid var(--border);
    display: flex;
    justify-content: flex-start;
    align-items: center;
    padding: 0 16px;
    z-index: 1002;
    box-shadow: 0 -1px 3px rgba(0, 0, 0, 0.1);
    gap: 10px;
}
@media (min-width: 769px) {
    .fixed-footer-controls {
        display: none;
    }
    .footer {
        padding: 16px;
    }
}
@media (max-width: 768px) {
    .zoom-container main {
        padding-bottom: 120px;
    }
}
/* =====================================================
   ✨ NOVOS ESTILOS PARA A PÁGINA INICIAL
   ===================================================== */
.hero-section {
    width: 100%;
    max-width: 1000px;
    margin: 65px auto 0;
    height: 400px;
    background: var(--surface);
    border-radius: 0px;
    box-shadow: var(--shadow-lg);
    position: relative;
    overflow: hidden;
}
.hero-slide {
    width: 100%;
    height: 100%;
    position: absolute;
    opacity: 0;
    transition: opacity 1s ease-in-out;
    text-decoration: none;
}
.hero-slide.active {
    opacity: 1;
}
.hero-slide img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}
.hero-info {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: linear-gradient(0deg, rgba(0,0,0,0.8) 0%, transparent 100%);
    padding: var(--spacing-md);
    color: white;
}
/* ATUALIZAÇÃO: Título Fixo para o Anime Tema */
.hero-info h2 {
    font-size: var(--font-size-lg);
    font-weight: 700;
    text-shadow: 0 2px 4px rgba(0,0,0,0.5);
    white-space: nowrap; /* Garante que o título do anime não quebre */
    overflow: hidden;
    text-overflow: ellipsis;
}
.hero-info p {
    font-size: var(--font-size-sm);
    text-shadow: 0 1px 2px rgba(0,0,0,0.5);
}

/* NOVO: Estilo para informações complementares do anime */
.anime-details-section {
    width: 100%;
    max-width: 1000px;
    margin: 10px auto 0;
    padding: 0 0.75rem;
    background: var(--card-bg);
    border-radius: 0px;
    box-shadow: var(--shadow);
    color: var(--text-primary);
}
.anime-details-content {
    padding: 20px;
}
.anime-details-title {
    font-size: var(--font-size-lg);
    font-weight: 700;
    margin-bottom: 15px;
    color: var(--text-primary);
    border-bottom: 2px solid var(--highlight-color);
    padding-bottom: 10px;
}
.anime-details-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
}
.anime-detail-item {
    display: flex;
    flex-direction: column;
}
.anime-detail-label {
    font-size: var(--font-size-xs);
    color: var(--text-secondary);
    text-transform: uppercase;
    margin-bottom: 5px;
    font-weight: 600;
}
.anime-detail-value {
    font-size: var(--font-size-sm);
    color: var(--text-primary);
    font-weight: 500;
}

/* ===== CONFIGURAÇÃO FÁCIL: MUDE SÓ AQUI ===== */
:root {
    --linha-comprimento: 238px;  /* <<--- MUDE AQUI PARA CONTROLAR TODAS AS LINHAS */
    --linha-cor: var(--highlight-color);
    --linha-espessura: 0.7px;
}
/* ============================================ */
/* Estilo do título */
.carousel-title {
    position: relative;
    display: inline-block;
    font-family: 'Ubuntu', sans-serif;
    font-size: var(--font-size-lg);
    font-weight: 700;
    color: var(--text-primary);
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 15px;
    padding: 5px 0;
    line-height: 1;
    cursor: pointer;
    width: fit-content;
    z-index: 1;
}
/* Linha vermelha com tamanho fixo */
.carousel-title::after {
    content: '';
    position: absolute;
    left: 0;
    bottom: 0;
    height: var(--linha-espessura);
    background: var(--linha-cor);
    width: var(--linha-comprimento); /* <<--- MESMO TAMANHO PARA TODOS */
    z-index: -1;
}
/* Estilo para carrossel com movimento lateral */
.carousel-horizontal {
    display: flex;
    overflow-x: scroll;
    padding-bottom: 15px;
    gap: var(--spacing-md);
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
    overscroll-behavior-x: contain;
}
/* Ajuste para mostrar 4 colunas no carrossel horizontal (exceto episódios) */
#saihate-details-carousel .anime-card,
#isekai-animes-carousel .anime-card {
    scroll-snap-align: start;
    flex-shrink: 0;
    /* Ajustado para 4 colunas visíveis no desktop */
    width: calc((100% - 3 * var(--spacing-md)) / 4); /* (100% - (4-1) * gap) / 4 */
}
/* Ajuste para mostrar 3 colunas no carrossel de episódios */
#episodes-carousel .anime-card {
    scroll-snap-align: start;
    flex-shrink: 0;
    /* Ajustado para 3 colunas visíveis no desktop */
    width: calc((100% - 2 * var(--spacing-md)) / 3); /* (100% - (3-1) * gap) / 3 */
}
/* O carrossel normal deve ser estático (grid) */
.anime-grid {
    display: grid;
    /* Manter o grid de 4 colunas em desktop */
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: var(--spacing-md);
}
/* Grid para detalhes/personagens com 4 colunas */
.anime-grid#saihate-details-grid {
    grid-template-columns: repeat(4, 1fr);
}
.anime-card {
    background: var(--card-bg);
    border-radius: 0px;
    box-shadow: var(--shadow);
    transition: var(--transition);
    /* Removido text-decoration: none; */
    color: var(--text-primary);
    overflow: hidden;
    opacity: 0;
    transform: translateY(10px);
    animation: fadeIn 0.5s ease-out forwards;
    /* Altura fixa para todos os cards no grid */
    display: flex;
    flex-direction: column;
    height: 100%; /* Permite que o display flex funcione */
    cursor: pointer; /* Adicionado cursor para indicar clique */
}
.anime-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-lg);
}
/* CLASSE DE IMAGEM PADRÃO (Proporção 140% de padding-bottom é 1.4:1) */
.anime-card-image {
    width: 100%;
    padding-bottom: 140%;
    background-size: cover;
    background-position: center;
    background-color: var(--surface);
    flex-shrink: 0;
}
/* Classe de imagem para cards que usam altura fixa (Detalhes, etc.) */
.anime-card-image-fixed-height {
    width: 100%;
    height: 280px; /* Altura padrão desktop */
    padding-bottom: 0;
    background-size: cover;
    background-position: center;
    background-color: var(--surface);
    flex-shrink: 0;
}
/* CLASSE ESPECÍFICA PARA OS CARDS DE EPISÓDIO */
.episode-card-image {
    width: 100%;
    padding-bottom: 56.25%; /* Proporção 16:9 para thumb de vídeo */
    background-size: cover;
    background-position: center;
    background-color: var(--surface);
    flex-shrink: 0;
}
.anime-card-info {
    padding: var(--spacing-sm);
    /* Garante que o texto use o espaço restante, mantendo a altura do card */
    flex-grow: 1;
}
.anime-card-title {
    font-size: var(--font-size-sm);
    font-weight: 600;
    /* Permite que o texto quebre para garantir o mesmo tamanho do card */
    display: -webkit-box;
    -webkit-line-clamp: 2; /* Limita a 2 linhas */
    -webkit-box-orient: vertical;
    overflow: hidden;
    white-space: normal; /* Permite a quebra de linha */
    height: calc(var(--font-size-sm) * 1.5 * 2); /* Altura de 2 linhas */
}
.anime-card-subtitle {
    font-size: var(--font-size-xs);
    color: var(--text-secondary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}
/* ==========================================================
   ✨ ALTERAÇÕES PARA 4 COLUNAS NO MOBILE (SOLICITADO)
   ========================================================== */
@media (max-width: 768px) {
    .hero-section {
        height: 300px;
        margin-top: 55px;
    }
    .anime-grid {
        display: grid;
        overflow-x: hidden;
        /* Colunas mobile */
        grid-template-columns: repeat(4, 1fr);
        gap: calc(var(--spacing-sm) / 1.5);
    }
    .anime-grid#saihate-details-grid {
        grid-template-columns: repeat(2, 1fr); /* 2 colunas em mobile para cards maiores */
    }
    .anime-card {
        width: 100%;
        flex-shrink: 1;
        height: 100%;
        .anime-card-info {
             padding: calc(var(--spacing-sm) / 2);
        }
        .anime-card-title {
             font-size: calc(var(--font-size-xs) * 0.9);
             height: calc(calc(var(--font-size-xs) * 0.9) * 1.5 * 2); /* Ajusta altura do título para 2 linhas mobile */
        }
        .anime-card-subtitle {
             font-size: calc(var(--font-size-xs) * 0.8);
        }
    }
    /* Ajuste da largura dos cards no carrossel horizontal em mobile */
    #saihate-details-carousel .anime-card,
    #isekai-animes-carousel .anime-card {
        /* Ajustado para 4 colunas visíveis em mobile */
        width: calc((100% - 3 * var(--spacing-md)) / 4); /* (100% - (4-1) * gap) / 4 */
    }
    /* Ajuste da largura dos cards no carrossel de episódios em mobile */
    #episodes-carousel .anime-card {
        /* Ajustado para 3 colunas visíveis em mobile */
        width: calc((100% - 2 * var(--spacing-md)) / 3); /* (100% - (3-1) * gap) / 3 */
    }
    /* Ajuste da altura fixa da imagem no mobile (menor) */
    .anime-card-image-fixed-height {
        height: 120px; /* <-- Altura ajustada para mobile */
        padding-bottom: 0;
    }
    /* Ajuste da imagem padrão no mobile */
    .anime-card-image {
        padding-bottom: 140%;
    }
    /* Ajuste da imagem de episódio no mobile (16:9) */
    .episode-card-image {
        padding-bottom: 56.25%;
    }
}
@media (max-width: 480px) {
    .hero-section {
        height: 250px;
    }
    .anime-grid {
        grid-template-columns: repeat(3, 1fr); /* Reduzido para 3 colunas em mobile extremo para legibilidade */
        gap: calc(var(--spacing-sm) / 2);
    }
    .anime-grid#saihate-details-grid {
        grid-template-columns: repeat(1, 1fr); /* 1 coluna em mobile extremo */
    }
     .anime-card-image-fixed-height {
        height: 100px; /* Reduz um pouco mais no mobile extremo */
    }
    /* Ajuste da largura dos cards no carrossel horizontal em mobile extremo */
    #saihate-details-carousel .anime-card,
    #isekai-animes-carousel .anime-card {
        /* Ajustado para 4 colunas visíveis em mobile extremo */
        width: calc((100% - 3 * var(--spacing-md)) / 4); /* (100% - (4-1) * gap) / 4 */
    }
    /* Ajuste da largura dos cards no carrossel de episódios em mobile extremo */
    #episodes-carousel .anime-card {
        /* Ajustado para 3 colunas visíveis em mobile extremo */
        width: calc((100% - 2 * var(--spacing-md)) / 3); /* (100% - (3-1) * gap) / 3 */
    }
}
    </style>
</head>
<body data-theme="light">
    <div class="header-menu">
        <nav class="header">
            <div class="top-bar__section">
                <h1><i class="fas fa-heart-crack" style="color:#E53E3E;"></i>Saihate no Paladin Fan</h1>
            </div>
            <div class="top-bar__section">
                <button aria-label="Abrir busca" class="top-bar__icon" id="menu-icon">
                    <i class="fas fa-search"></i>
                </button>
                <button aria-label="Alternar tema" class="top-bar__icon" id="theme-toggle">
                    <i class="fas fa-adjust"></i>
                </button>
                <button aria-label="Abrir menu" class="top-bar__icon" id="hamburger-btn">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </nav>
        <nav class="menu" id="main-menu">
            <div class="search-container">
                <input type="text" class="search-input" placeholder="Pesquisar anime..." id="search-input">
                <i class="fas fa-search search-icon"></i>
            </div>
            <div class="result-card" id="result-card"></div>
        </nav>
       <div class="hamburger-menu" id="hamburgerMenu">
            <a href="javascript:showNotification('Sistema em construção, volte mais tarde.')" class="menu-item"><i class="fas fa-user-plus"></i> Cadastre-se</a>
            <a href="javascript:showNotification('Sistema em construção, volte mais tarde.')" class="menu-item"><i class="fas fa-sign-in-alt"></i> Login</a>
            <a href="javascript:showNotification('Sistema em construção, volte mais tarde.')" class="menu-item"><i class="fas fa-star"></i> Populares</a>
            <a href="javascript:showNotification('Sistema em construção, volte mais tarde.')" class="menu-item"><i class="fas fa-sort-alpha-down"></i> A - Z</a>
            <a href="javascript:showNotification('Sistema em construção, volte mais tarde.')" class="menu-item"><i class="fas fa-masks-theater"></i> Gêneros</a>
            <a href="javascript:showNotification('Sistema em construção, volte mais tarde.')" class="menu-item"><i class="fas fa-info-circle"></i> Sobre</a>
            <button class="top-bar__icon" id="openReportModalBtn" onclick="openReportModal()">
                <i class="fas fa-bug"></i> Reportar Erro
            </button>
        </div>
        <div class="menu-overlay" id="menuOverlay"></div>
    <div class="zoom-container" id="zoom-container">
        <section class="hero-section" id="hero-section">
            <div class="hero-slide active" data-anime-title="Saihate no Paladin..." data-anime-image="https://i.postimg.cc/HnHVRk4y/images-2025-11-11T222800-016.jpg">
                <img src="" alt="Destaque" id="hero-image" />
                <div class="hero-info">
                    <h2 id="hero-title">Saihate no Paladin</h2>
                    <p id="hero-subtitle">O Paladino do Fim do Mundo</p>
                </div>
            </div>
        </section>
        <!-- NOVO: Seção de detalhes do anime -->
        <section class="anime-details-section" id="anime-details-section">
            <div class="anime-details-content">
                <h3 class="anime-details-title" id="details-anime-title">Detalhes do Anime</h3>
                <div class="anime-details-grid">
                    <div class="anime-detail-item">
                        <span class="anime-detail-label">Sinopse</span>
                        <p class="anime-detail-value" id="details-anime-synopsis">Sinopse não disponível.</p>
                    </div>
                    <div class="anime-detail-item">
                        <span class="anime-detail-label">Gênero</span>
                        <p class="anime-detail-value" id="details-anime-genre">-</p>
                    </div>
                    <div class="anime-detail-item">
                        <span class="anime-detail-label">Qualidade</span>
                        <p class="anime-detail-value" id="details-anime-quality">-</p>
                    </div>
                    <div class="anime-detail-item">
                        <span class="anime-detail-label">Áudio</span>
                        <p class="anime-detail-value" id="details-anime-audio">-</p>
                    </div>
                    <div class="anime-detail-item">
                        <span class="anime-detail-label">Episódios</span>
                        <p class="anime-detail-value" id="details-anime-episodes">-</p>
                    </div>
                </div>
            </div>
        </section>
        <main style="width:100%;max-width:1000px;padding:0 0.75rem 120px;margin:0 auto;">
            <section class="anime-carousel-section" id="episodes-section">
                <h2 class="carousel-title" data-link-id="episodes">EPISÓDIOS</h2>
                <div id="episodes-carousel">
                    </div>
            </section>
            <section class="anime-carousel-section" id="saihate-details-section">
                <h2 class="carousel-title" data-link-id="saihate">Detalhes e Personagens de 'Saihate no Paladin'</h2>
                <div class="carousel-horizontal" id="saihate-details-carousel">
                </div>
            </section>
            <section class="anime-carousel-section" id="isekai-section">
                <h2 class="carousel-title" data-link-id="isekai">Outros Animes Isekai Recomendados</h2>
                <div class="carousel-horizontal" id="isekai-animes-carousel">
                </div>
            </section>
            </main>
    </div>
    <div class="footer">
        <div class="footer-left">
            </div>
        <div class="footer-right">
            <p>© 2025 Fanpage Saihate no Paladin. Desenvolvido por xAI.</p>
        </div>
    </div>
    <div class="fixed-footer-controls">
        <button aria-label="Diminuir zoom" class="top-bar__icon" id="zoom-out-btn-fixed">
            <i class="fas fa-search-minus"></i>
        </button>
        <button aria-label="Aumentar zoom" class="top-bar__icon" id="zoom-in-btn-fixed">
            <i class="fas fa-search-plus"></i>
        </button>
    </div>
    <div class="notification" id="notification"></div>
    <div class="modal-overlay" id="reportErrorModal">
        <div class="modal-content">
            <h3><i class="fas fa-exclamation-triangle"></i> Reportar Problema</h3>
            <p>Selecione o problema encontrado (ex: link quebrado):</p>
            <button class="report-option" data-error-type="Link Quebrado"><i class="fas fa-link-slash"></i> Link Quebrado</button>
            <button class="report-option" data-error-type="Imagem Faltando"><i class="fas fa-image-slash"></i> Imagem Faltando</button>
            <button class="report-option" data-error-type="Outro Problema"><i class="fas fa-puzzle-piece"></i> Outro Problema</button>
            <button class="modal-close-btn" id="closeReportModal">Cancelar</button>
        </div>
    </div>
    <div class="modal-overlay" id="detailsModal">
        <div class="modal-content">
            <h3 id="detailsTitle"></h3>
            <div class="modal-main-content">
                <div class="modal-trailer-container">
                    <iframe id="trailerVideo" class="trailer-video" width="560" height="315" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
                <div class="modal-synopsis-container">
                    <h4>Sinopse:</h4>
                    <p id="synopsisText"></p>
                </div>
            </div>
            <button class="modal-close-btn" id="closeDetailsModal">Fechar</button>
        </div>
    </div>
    <div class="modal-overlay" id="rpgModal">
        <div class="modal-content">
            <h3 id="rpgTitle"></h3>
            <div class="modal-rpg-content">
                <div class="modal-rpg-image" id="rpgImage"></div>
                <div class="modal-rpg-info">
                    <p id="rpgSynopsis"></p>
                </div>
            </div>
            <button class="modal-close-btn" id="closeRpgModal">Fechar</button>
        </div>
    </div>
    <div class="modal-overlay" id="episodeModal">
        <div class="modal-content">
            <h3 id="episodeTitle"></h3>
            <div class="modal-episode-content">
                <div class="modal-episode-image" id="episodeImage"></div>
                <div class="modal-episode-info">
                    <p id="episodeSynopsis"></p>
                </div>
            </div>
            <button class="modal-close-btn" id="closeEpisodeModal">Fechar</button>
        </div>
    </div>
    <script type="module">
        // Importações e Configurações de Firebase (Mantidas do original)
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js';
        import { getAnalytics, logEvent } from 'https://www.gstatic.com/firebasejs/10.13.1/firebase-analytics.js';
        import { getFirestore, collection, getDocs, doc, getDoc, addDoc } from 'https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore.js';
        console.log('1. [INICIALIZAÇÃO] Iniciando script...');
        const firebaseConfig = {
            apiKey: "AIzaSyA9vB_anmutvZByIhKxsPJbsP0VZ7gyWB0",
            authDomain: "sorteio-mega-sorte.firebaseapp.com",
            projectId: "sorteio-mega-sorte",
            storageBucket: "sorteio-mega-sorte.appspot.com",
            messagingSenderId: "776750928407",
            appId: "1:776750928407:web:72da06deb8b97302b5c252",
            measurementId: "G-GD7D30N0G"
        };
        console.log('2. [FIREBASE] Configurações carregadas.');
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getFirestore(app);
        console.log('3. [FIREBASE] App, Analytics e Firestore inicializados.');
        // Constantes Globais
        const CONSTRUCTION_LINK = "javascript:showNotification('Sistema em construção, volte mais tarde.')";
        const CONSTRUCTION_SUBTITLE = "Sistema em construção";
        // ✨ LINK FINAL DO EPISÓDIO (PODE SER ALTERADO DEPOIS)
        const EPISODE_PLAYER_LINK = (episodeNumber) => `javascript:showNotification('Redirecionando para o player do Episódio ${episodeNumber}. Link para player será inserido aqui.')`;
        // ==========================================================
        // ✨ DADOS ATUALIZADOS E NOVOS DADOS
        // ==========================================================
        const homepageData = {
            hero: [
                // Primeiro item para a capa inicial (Anime tema)
                {
                    title: "Saihate no Paladin",
                    subtitle: "O Paladino do Fim do Mundo",
                    image: "https://i.postimg.cc/fy65V1NC/57463899dc6945e02bd17e20ea23f0b030f590789c24f52ec820b9aeb5f3bdcc-SX1080-FMjpg.jpg",
                    url: "saihate_no_paradin.html", // Link real para a própria página
                    synopsis: "Uma cidade dos mortos... Will é criado por três mortos-vivos e embarca em um caminho para se tornar um paladino.",
                    genre: "Isekai, Aventura, Fantasia",
                    quality: "1080p",
                    audio: "Legendado",
                    episodes: "12"
                },
                { title: "My Hero Academy final", subtitle: "A nova temporada está aqui!", image: "https://i.postimg.cc/767RBnPq/f144ebc9f61c734140f789b23edc4eeb.jpg", url: CONSTRUCTION_LINK },
                { title: "My Status as an Assassin Obviously Exceeds the Hero's", subtitle: "Oda Akira, um estudante do ensino médio...", image: "https://i.postimg.cc/gkhR2sDs/28253-1-9-8b.webp", url: CONSTRUCTION_LINK },
                { title: "L9999", subtitle: "Ele quase foi morto nas profundezas da masmorra...", image: "https://i.postimg.cc/GtCq0rHT/28329-1_9_8b.webp", url: CONSTRUCTION_LINK }
            ],
            // ✨ NOVO: Lista de Episódios
            episodeList: [
                // Use a proporção 16:9 (episode-card-image) para thumbs de vídeo
                { 
                    title: "E1 ∙ O Menino da Cidade dos Mortos", 
                    subtitle: "Disponível em HD", 
                    image: "https://i.postimg.cc/767RBnPq/f144ebc9f61c734140f789b23edc4eeb.jpg", 
                    url: "saihate_no_paradin_ep1.html", // <-- ALTERADO PARA O CAMINHO CORRETO
                    animeTitle: "Saihate no Paladin",
                    description: "Will é encontrado e adotado por três mortos-vivos em uma cidade de mortos. Ele cresce com os três e demonstra um talento mágico extraordinário. Ele decide sair para se tornar um paladino."
                },
                { 
                    title: "Episódio 2: O Reino dos Mortos", 
                    subtitle: "Novo!", 
                    image: "https://i.postimg.cc/767RBnPq/f144ebc9f61c734140f789b23edc4eeb.jpg", 
                    url: EPISODE_PLAYER_LINK(2), // <-- Mantém o comportamento original para outros episódios
                    animeTitle: "Saihate no Paladin",
                    description: "Will começa sua jornada e enfrenta os desafios do mundo exterior, aprendendo sobre a vida dos vivos."
                },
                { 
                    title: "Episódio 3: A Batalha Final", 
                    subtitle: "Novo!", 
                    image: "https://i.postimg.cc/767RBnPq/f144ebc9f61c734140f789b23edc4eeb.jpg", 
                    url: EPISODE_PLAYER_LINK(3), // <-- Mantém o comportamento original para outros episódios
                    animeTitle: "Saihate no Paladin",
                    description: "Will e seus companheiros enfrentam um inimigo poderoso que ameaça a paz de uma vila."
                },
                { 
                    title: "Episódio 4: O Legado do Herói", 
                    subtitle: "Novo!", 
                    image: "https://i.postimg.cc/767RBnPq/f144ebc9f61c734140f789b23edc4eeb.jpg", 
                    url: EPISODE_PLAYER_LINK(4), // <-- Mantém o comportamento original para outros episódios
                    animeTitle: "Saihate no Paladin",
                    description: "Will descobre mais sobre seu passado e o legado de seus pais adotivos."
                },
                { 
                    title: "Episódio 5: O Fim do Mundo", 
                    subtitle: "Pré-lançamento", 
                    image: "https://i.postimg.cc/767RBnPq/f144ebc9f61c734140f789b23edc4eeb.jpg", 
                    url: CONSTRUCTION_LINK, // <-- Mantém o comportamento original para outros episódios
                    animeTitle: "Saihate no Paladin",
                    description: "Will e seus amigos descobrem uma antiga profecia sobre o fim do mundo."
                },
                { 
                    title: "Episódio 6: O Paladino Eterno", 
                    subtitle: "Em breve", 
                    image: "https://i.postimg.cc/767RBnPq/f144ebc9f61c734140f789b23edc4eeb.jpg", 
                    url: CONSTRUCTION_LINK, // <-- Mantém o comportamento original para outros episódios
                    animeTitle: "Saihate no Paladin",
                    description: "Will finalmente alcança seu objetivo de se tornar um verdadeiro paladino."
                },
            ],
            // Carrosséis estáticos (Mantidos)
            saiHateDetails: [
                { 
                    title: "William G. Maryblood", 
                    subtitle: "Will, o Paladino", 
                    image: "https://i.postimg.cc/X7QTvYG4/454875.jpg", 
                    url: CONSTRUCTION_LINK, 
                    synopsis: "Will é o protagonista, um menino humano criado por três mortos-vivos em uma cidade de mortos. Ele é um gênio mágico e aspira se tornar um paladino, um cavaleiro sagrado. Saiba mais sobre sua infância, poderes e missão.", 
                    trailerId: "aecUbrAIaiU" 
                },
                { 
                    title: "Robina Goodfellow", 
                    subtitle: "trovadora viajante", 
                    image: "https://i.postimg.cc/G3ZZ85qr/454883.jpg", 
                    url: CONSTRUCTION_LINK, 
                    synopsis: "Robina Goodfellow é uma trovadora viajante halfling e amiga íntima de William.Ela adora espalhar histórias de feitos heroicos para o público através de contos poéticos e canções.Ela é muito alegre e extrovertida quando está com outras pessoas.Possui carisma e entusiasmo suficientes para atrair multidões para suas histórias e adora comer bem, aparentemente por causa de sua herança halfling.", 
                    trailerId: "placeholder"
                },
                { title: "Meneldor", subtitle: "arqueiro meio-elfo", image: "https://i.postimg.cc/BZyFfxNx/454880.jpg", url: CONSTRUCTION_LINK, synopsis: "Um arqueiro meio-elfo que Will encontra na estrada após sair de casa. Embora rude e relutante devido a experiências ruins do passado, ele acaba aceitando William como o primeiro amigo de verdade que teve na vida.", trailerId: "placeholder" },
                { title: "Gracefeel", subtitle: "divindade guardiã de William. ", image: "https://i.postimg.cc/mgZVt3xn/454879.jpg", url: CONSTRUCTION_LINK, synopsis: "Conheça o mundo de onde Will veio e os desafios que enfrenta ao sair da cidade dos mortos.", trailerId: "placeholder" },
                { title: "Blood", subtitle: "divindade guardiã de William. ", image: "https://i.postimg.cc/fT8mq6F1/454877.jpg", url: CONSTRUCTION_LINK, synopsis: "Um dos três heróis que ajudam a selar o Grande Rei.Eles fazem um pacto com Stagnate, a deusa dos mortos - vivos, para serem transformados em mortos - vivos a fim de proteger o selo do Grande Rei.Ele treina William, o espadachim.", trailerId: "placeholder" },
                { title: "Augusto", subtitle: "feiticeiro espectral ", image: "https://i.postimg.cc/prGrktT6/454878.jpg", url: CONSTRUCTION_LINK, synopsis: "Gus é um feiticeiro espectral, avô adotivo de Will e também seu professor de feitiçaria e economia. Ele é um velho rabugento que não gostava de ser aprisionado, então fez um voto a Whirl, o Deus do Vento, de viver sua vida do jeito que escolhesse e desfrutá-la.", trailerId: "placeholder" },
                { title: "Reystov", subtitle: "aventureiro ", image: "https://i.postimg.cc/zXH84hPV/509014.jpg", url: CONSTRUCTION_LINK, synopsis: "Um aventureiro que Will contrata em Whitesails. Originalmente membro de uma tribo das montanhas em uma região conhecida como Fogão de Volt, ele se tornou um guerreiro para vingar sua família após o massacre cometido por uma aldeia vizinha, mas posteriormente desistiu dessa busca por vingança e se tornou um renomado guerreiro aventureiro.", trailerId: "placeholder" },
                { title: "Estagnar", subtitle: "Entidade ", image: "https://i.postimg.cc/L8T9Vpb3/454881.jpg", url: CONSTRUCTION_LINK, synopsis: "Deus dos Mortos-Vivos", trailerId: "placeholder" },
                { title: "Antonio", subtitle: "vendedor ambulante ", image: "https://i.postimg.cc/L8T9Vpb3/454881.jpg", url: CONSTRUCTION_LINK, synopsis: "Antonio é um vendedor ambulante e amigo de confiança de William. Ele é um negociador altamente habilidoso e conhece bem o ramo do comércio.É amigável e transmite uma impressão de paz aos outros.", trailerId: "placeholder" }
            ],
            // Outros animes (Mantidos)
            isekaiAnimes: [
                { title: "The Faraway Paladin", subtitle: "12 Episódios (Isekai)", image: "https://i.postimg.cc/HnHVRk4y/images-2025-11-11T222800-016.jpg", url: "saihate_no_paradin.html", synopsis: "Uma cidade dos mortos... Will é criado por três mortos-vivos e embarca em um caminho para se tornar um paladino.", trailerId: "placeholder", genre: "Isekai, Aventura, Fantasia", quality: "1080p", audio: "Legendado", episodes: "12" },
                { title: "Mushoku Tensei", subtitle: "2 Temporadas (Isekai)", image: "https://i.postimg.cc/yxt4hMkM/images-16.webp", url: CONSTRUCTION_LINK, synopsis: "Um NEET recluso é reencarnado em um mundo de fantasia com memórias intactas e decide viver sua nova vida ao máximo.", trailerId: "placeholder", genre: "Isekai, Aventura, Drama", quality: "720p", audio: "Dublado", episodes: "23" },
                { title: "Overlord", subtitle: "4 Temporadas (Isekai)", image: "https://i.postimg.cc/Tw040ZHV/images-2025-11-11T111248-289.jpg", url: CONSTRUCTION_LINK, synopsis: "Um jogador de MMO é transportado para o mundo do seu jogo, tornando-se o poderoso Ainz Ooal Gown.", trailerId: "placeholder", genre: "Isekai, Ação, Fantasia", quality: "1080p", audio: "Legendado", episodes: "50" },
                { title: "The Rising of the Shield Hero", subtitle: "3 Temporadas (Isekai)", image: "https://i.postimg.cc/m2zm1zR8/IMG-20251111-111359.jpg", url: CONSTRUCTION_LINK, synopsis: "O herói do escudo, um dos quatro heróis lendários, é traído e precisa reconstruir sua reputação.", trailerId: "placeholder", genre: "Isekai, Aventura, Ação", quality: "1080p", audio: "Dublado", episodes: "40" },
                { title: "Re:Zero", subtitle: "2 Temporadas (Isekai)", image: "https://i.postimg.cc/bNtRN7H4/IMG-20251111-111459.jpg", url: CONSTRUCTION_LINK, synopsis: "Natsuki Subaru, um estudante de ensino médio, é invocado para outro mundo e ganha o poder de 'Retornar pela Morte'.", trailerId: "placeholder", genre: "Isekai, Drama, Suspense", quality: "1080p", audio: "Legendado", episodes: "47" },
                { title: "Konosuba", subtitle: "3 Temporadas (Isekai Comédia)", image: "https://i.postimg.cc/ZY9QpDLk/filters-quality-95-format-webp-6.jpg", url: CONSTRUCTION_LINK, synopsis: "Um NEET é reencarnado em um mundo de RPG com uma deusa inútil e uma missão para derrotar o Rei Demônio.", trailerId: "placeholder", genre: "Isekai, Comédia, Fantasia", quality: "720p", audio: "Dublado", episodes: "30" },
                { title: "That Time I Got Reincarnated as a Slime", subtitle: "2 Temporadas (Isekai)", image: "https://i.postimg.cc/VLqDFyr0/81lBpKcTSrL.jpg", url: CONSTRUCTION_LINK, synopsis: "Um trabalhador é esfaqueado e reencarna como um slime com habilidades únicas.", trailerId: "placeholder", genre: "Isekai, Aventura, Comédia", quality: "1080p", audio: "Legendado", episodes: "47" },
            ],
        };
        // Combina animes relevantes para o Carrossel de Recomendações (horizontal no topo)
        const allAnimes = [
            ...homepageData.saiHateDetails,
            ...homepageData.isekaiAnimes,
        ];
        // ==========================================================
        // ✨ FUNÇÕES DE RENDERIZAÇÃO E LÓGICA (Com Edições)
        // ==========================================================
        window.searchAnimes = async (query) => {
            // Lógica de busca mantida
        };
        async function getIPAddress() {
            // Lógica de IP mantida
        }
        async function recordReportError(errorType) {
            // Lógica de reporte de erro mantida
        }
        function openHamburgerMenu() {
            document.getElementById('hamburgerMenu')?.classList.add('open');
            document.getElementById('menuOverlay')?.classList.add('active');
        }
        function closeHamburgerMenu() {
            document.getElementById('hamburgerMenu')?.classList.remove('open');
            document.getElementById('menuOverlay')?.classList.remove('active');
        }
        window.closeHamburgerMenu = closeHamburgerMenu;
        function openReportModal() {
            const modal = document.getElementById('reportErrorModal');
            if (modal) modal.style.display = 'flex';
        }
        function closeReportModal() {
            const modal = document.getElementById('reportErrorModal');
            if (modal) modal.style.display = 'none';
        }
        function showNotification(message) {
            const notification = document.getElementById('notification');
            if (!notification) return;
            notification.textContent = message;
            notification.classList.add('show');
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }
        window.showNotification = showNotification;
        function openDetailsModal(title, synopsis, trailerId) {
            const modal = document.getElementById('detailsModal');
            const titleElem = document.getElementById('detailsTitle');
            const textElem = document.getElementById('synopsisText');
            const trailerFrame = document.getElementById('trailerVideo');
            if (modal && titleElem && textElem && trailerFrame) {
                titleElem.textContent = title;
                textElem.textContent = synopsis;
                let trailerUrl = '';
                if (trailerId && trailerId !== 'placeholder') {
                    // Monta a URL do YouTube com autoplay e modo sem cookies
                    trailerUrl = `https://www.youtube-nocookie.com/embed/${trailerId}?autoplay=1&mute=0&controls=1&rel=0&showinfo=0&loop=0`;
                } else {
                    // Placeholder ou link de vídeo de erro
                    trailerUrl = `https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=1&mute=1&controls=0`; // Rickroll mudo
                }
                trailerFrame.src = trailerUrl;
                modal.style.display = 'flex';
            }
        }
        function closeDetailsModal() {
            const modal = document.getElementById('detailsModal');
            const trailerFrame = document.getElementById('trailerVideo');
            if (modal && trailerFrame) {
                // Para o vídeo limpando o src do iframe
                trailerFrame.src = '';
                modal.style.display = 'none';
            }
        }
        // ✨ NOVA FUNÇÃO PARA MODAL RPG (Personagem)
        function openRpgModal(title, synopsis, image) {
            const modal = document.getElementById('rpgModal');
            const titleElem = document.getElementById('rpgTitle');
            const textElem = document.getElementById('rpgSynopsis');
            const imageElem = document.getElementById('rpgImage');
            if (modal && titleElem && textElem && imageElem) {
                titleElem.textContent = title;
                textElem.textContent = synopsis;
                imageElem.style.backgroundImage = `url('${image}')`;
                modal.style.display = 'flex';
            }
        }
        function closeRpgModal() {
            const modal = document.getElementById('rpgModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }
        // ✨ NOVA FUNÇÃO PARA MODAL DE EPISÓDIO
        function openEpisodeModal(title, description, image) {
            const modal = document.getElementById('episodeModal');
            const titleElem = document.getElementById('episodeTitle');
            const textElem = document.getElementById('episodeSynopsis');
            const imageElem = document.getElementById('episodeImage');
            if (modal && titleElem && textElem && imageElem) {
                titleElem.textContent = title;
                textElem.textContent = description;
                imageElem.style.backgroundImage = `url('${image}')`;
                modal.style.display = 'flex';
            }
        }
        function closeEpisodeModal() {
            const modal = document.getElementById('episodeModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }
        // ✨ NOVA FUNÇÃO PARA ATUALIZAR A SEÇÃO HERO
        function updateHeroSection(newTitle, newImage) {
            const heroTitle = document.getElementById('hero-title');
            const heroSubtitle = document.getElementById('hero-subtitle');
            const heroImage = document.getElementById('hero-image');
            if (heroTitle) heroTitle.textContent = newTitle;
            if (heroSubtitle) heroSubtitle.textContent = 'Episódio Selecionado';
            if (heroImage) heroImage.src = newImage;
        }

        // ✨ NOVA FUNÇÃO PARA ATUALIZAR A SEÇÃO DE DETALHES DO ANIME
        function updateAnimeDetails(animeDetails) {
            const title = document.getElementById('details-anime-title');
            const synopsis = document.getElementById('details-anime-synopsis');
            const genre = document.getElementById('details-anime-genre');
            const quality = document.getElementById('details-anime-quality');
            const audio = document.getElementById('details-anime-audio');
            const episodes = document.getElementById('details-anime-episodes');

            if (title) title.textContent = animeDetails.title || 'Detalhes do Anime';
            if (synopsis) synopsis.textContent = animeDetails.synopsis || 'Sinopse não disponível.';
            if (genre) genre.textContent = animeDetails.genre || '-';
            if (quality) quality.textContent = animeDetails.quality || '-';
            if (audio) audio.textContent = animeDetails.audio || '-';
            if (episodes) episodes.textContent = animeDetails.episodes || '-';
        }

        /**
         * Renderiza os cards de anime no grid/carrossel
         * @param {string} containerId ID do elemento onde os cards serão renderizados
         * @param {Array} animeList Lista completa de animes a serem usados
         * @param {boolean} isHorizontal Se deve renderizar em layout horizontal (carousel)
         * @param {boolean} isEpisodeCard Se deve usar o layout de card de episódio (16:9)
         */
        function renderAnimeCards(containerId, animeList, isHorizontal = false, isEpisodeCard = false) {
            const container = document.getElementById(containerId);
            if (!container) return;
            if (isHorizontal) {
                container.classList.add('carousel-horizontal');
                container.classList.remove('anime-grid');
            } else {
                container.classList.add('anime-grid');
                container.classList.remove('carousel-horizontal');
            }
            // Limpa o conteúdo
            container.innerHTML = '';
            // Garante que não haja repetição de cards com os mesmos nomes
            const uniqueAnimes = animeList.filter((anime, index, self) =>
                index === self.findIndex((a) => (
                    a.title === anime.title
                ))
            );
            uniqueAnimes.forEach((anime, index) => {
                const card = document.createElement('div');
                // *** IMPORTANTE: REMOVIDO <a>. O link será tratado via Listener no final.
                const finalUrl = (anime.url === '#' || !anime.url) ? CONSTRUCTION_LINK : anime.url;
                const finalSubtitle = finalUrl.startsWith('javascript:') ? CONSTRUCTION_SUBTITLE : (anime.subtitle || '');
                card.className = 'anime-card';
                card.style.animationDelay = `${index * 50}ms`;
                card.dataset.url = finalUrl;
                card.dataset.title = anime.title;
                card.dataset.synopsis = anime.synopsis || 'Sinopse não disponível.';
                card.dataset.trailerid = anime.trailerId || ''; 
                card.dataset.image = anime.image || ''; // Adiciona a imagem no dataset
                card.dataset.description = anime.description || ''; // Adiciona a descrição no dataset
                // Adiciona os novos dados ao dataset
                card.dataset.genre = anime.genre || '';
                card.dataset.quality = anime.quality || '';
                card.dataset.audio = anime.audio || '';
                card.dataset.episodes = anime.episodes || '';
                // Escolhe a classe de imagem
                let imageClass = 'anime-card-image-fixed-height'; // Padrão para Detalhes
                if (isEpisodeCard) {
                    imageClass = 'episode-card-image'; // 16:9 para Episódios
                } else if (!isHorizontal) {
                    imageClass = 'anime-card-image'; // 1.4:1 para Grid Normal
                }
                if (anime.image) {
                    card.innerHTML = `
                        <div class="${imageClass}" style="background-image: url('${anime.image}')"></div>
                        <div class="anime-card-info">
                            <div class="anime-card-title">${anime.title}</div>
                            <div class="anime-card-subtitle">${finalSubtitle}</div>
                        </div>
                    `;
                } else {
                    card.innerHTML = `
                        <div class="anime-card-info" style="height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                            <div class="anime-card-title">${anime.title}</div>
                            <div class="anime-card-subtitle">${finalSubtitle}</div>
                        </div>
                    `;
                }
                container.appendChild(card);
            });
        }
        /**
         * Inicializa a renderização do carrossel
         * @param {string} containerId ID do elemento DOM onde renderizar
         * @param {Array} data A lista completa de dados do carrossel
         * @param {boolean} isHorizontal Se deve ser um carrossel horizontal
         */
        function initializeCarousel(containerId, data, isHorizontal = false, isEpisodeCard = false) {
            renderAnimeCards(containerId, data, isHorizontal, isEpisodeCard);
        }
        function buildHeroSlider(containerId, heroList) {
            const container = document.getElementById(containerId);
            if (!container) return;
            container.innerHTML = '';
            // Usamos apenas o primeiro item como capa inicial
            const item = heroList[0];
            const slide = document.createElement('div'); // Mudado para <div> para evitar clique
            slide.className = `hero-slide active`;
            slide.innerHTML = `
                <img src="${item.image}" alt="${item.title}" id="hero-image" loading="eager" />
                <div class="hero-info">
                    <h2 id="hero-title">${item.title}</h2>
                    <p id="hero-subtitle">${item.subtitle}</p>
                </div>
            `;
            container.appendChild(slide);
            // Atualiza os detalhes do anime principal logo após a criação da capa
            updateAnimeDetails(item);
            // Removemos a lógica de rotação automática para focar na atualização pelo clique
        }

        /**
         * Lógica para o carrossel de auto-scroll horizontal.
         */
        function setupAutoScrollCarousel(containerId, animeList) {
            const container = document.getElementById(containerId);
            if (!container) return;
            initializeCarousel(containerId, animeList, true, false); // Não é card de episódio
            const cards = container.querySelectorAll('.anime-card');
            if (cards.length === 0) return;

            let currentIndex = 0;
            let intervalId;
            const scrollInterval = 5000; 
            const pauseDuration = 10000; // 10 segundos
            let pauseTimeoutId = null;

            const startAutoScroll = () => {
                clearInterval(intervalId);
                intervalId = setInterval(() => {
                    const gap = parseInt(getComputedStyle(container).gap) || 0;
                    const cardWidth = cards[0] ? cards[0].offsetWidth + gap : 0;
                    if (cardWidth === 0) return;
                    currentIndex = (currentIndex + 1) % cards.length;
                    container.scrollTo({
                        left: currentIndex * cardWidth,
                        behavior: 'smooth'
                    });
                    if (currentIndex >= cards.length - 1) { 
                        setTimeout(() => {
                            container.scrollTo({ left: 0, behavior: 'auto' });
                            currentIndex = 0;
                        }, 300); 
                    }
                }, scrollInterval);
            };

            const stopAutoScroll = () => clearInterval(intervalId);
            const pauseAutoScroll = () => {
                stopAutoScroll();
                clearTimeout(pauseTimeoutId);
                pauseTimeoutId = setTimeout(startAutoScroll, pauseDuration);
            };

            const userInteractionHandler = () => {
                pauseAutoScroll();
            };

            // Adiciona o listener de clique ao container para pausar o carrossel
            container.addEventListener('click', userInteractionHandler);
            container.addEventListener('touchstart', userInteractionHandler);
            container.addEventListener('mousedown', userInteractionHandler);
            container.addEventListener('wheel', userInteractionHandler);
            container.addEventListener('scroll', userInteractionHandler);

            startAutoScroll();
        }

        // ==========================================================
        // ✨ CONSTRUÇÃO DA PÁGINA E EVENT LISTENERS
        // ==========================================================
        function buildHomepage() {
            console.log('[HOMEPAGE] Construindo página inicial (Dados Internos)...');
            buildHeroSlider('hero-section', homepageData.hero);
            // Carrosséis estáticos (Grid)
            initializeCarousel('saihate-details-carousel', homepageData.saiHateDetails, true); // Agora é um carrossel horizontal
            // Carrossel de Episódios (Horizontal e Manual)
            initializeCarousel('episodes-carousel', homepageData.episodeList, true, true); // true para horizontal e true para card de episódio
            // Carrossel "Outros Animes Isekai Recomendados" (Horizontal e Automático, com lista fixa)
            setupAutoScrollCarousel('isekai-animes-carousel', homepageData.isekaiAnimes);
        }
        const INITIAL_ZOOM = parseFloat(localStorage.getItem('zoomLevel')) || 0.75;
        const MIN_ZOOM = 0.5;
        const MAX_ZOOM = 1.5;
        function setupEventListeners() {
            console.log('13. [EVENTOS] Configurando event listeners...');
            const searchInput = document.getElementById('search-input');
            const menuToggle = document.getElementById('menu-icon');
            const mainMenu = document.getElementById('main-menu');
            const themeToggle = document.getElementById('theme-toggle');
            const body = document.body;
            const zoomInBtnFixed = document.getElementById('zoom-in-btn-fixed');
            const zoomOutBtnFixed = document.getElementById('zoom-out-btn-fixed');
            const hamburgerBtn = document.getElementById('hamburger-btn');
            const menuOverlay = document.getElementById('menuOverlay');
            const rootElement = document.documentElement;
            let currentScale = INITIAL_ZOOM;
            const step = 0.05;
            const baseFontSize = 16;
            function updateZoom(showNotif = true) {
                rootElement.style.fontSize = `${baseFontSize * currentScale}px`;
                localStorage.setItem('zoomLevel', currentScale.toFixed(2));
                const isDisabledMax = currentScale >= MAX_ZOOM;
                const isDisabledMin = currentScale <= MIN_ZOOM;
                if (zoomInBtnFixed) zoomInBtnFixed.disabled = isDisabledMax;
                if (zoomOutBtnFixed) zoomOutBtnFixed.disabled = isDisabledMin;
            }
            function handleZoom(direction) {
                if (direction === 'in') {
                    currentScale = Math.min(MAX_ZOOM, currentScale + step);
                } else if (direction === 'out') {
                    currentScale = Math.max(MIN_ZOOM, currentScale - step);
                }
                currentScale = parseFloat(currentScale.toFixed(2));
                updateZoom(true);
            }
            zoomInBtnFixed?.addEventListener('click', () => handleZoom('in'));
            zoomOutBtnFixed?.addEventListener('click', () => handleZoom('out'));
            updateZoom(false);
          // Clica no botão de zoom-in após 1 segundo
            setTimeout(() => {
                if (zoomInBtnFixed) zoomInBtnFixed.click();
                // Meio segundo depois, clica no botão de zoom-out
                setTimeout(() => {
                    if (zoomOutBtnFixed) zoomOutBtnFixed.click();
                }, 500);
            }, 1000);
            hamburgerBtn?.addEventListener('click', (e) => {
                e.stopPropagation();
                openHamburgerMenu();
            });
            menuOverlay?.addEventListener('click', closeHamburgerMenu);
            searchInput?.addEventListener('input', (e) => {
                window.searchAnimes(e.target.value);
            });
            menuToggle?.addEventListener('click', (e) => {
                e.stopPropagation();
                mainMenu.classList.toggle('open');
                if (mainMenu.classList.contains('open') && searchInput) {
                    setTimeout(() => searchInput.focus(), 300);
                }
            });
            document.addEventListener('click', (e) => {
                if (mainMenu && !e.target.closest('#main-menu') && !e.target.closest('#menu-icon') && mainMenu.classList.contains('open')) {
                    mainMenu.classList.remove('open');
                }
            });
            function toggleTheme() {
                const newTheme = body.dataset.theme === 'light' ? 'dark' : 'light';
                body.dataset.theme = newTheme;
                localStorage.setItem('theme', newTheme);
            }
            themeToggle?.addEventListener('click', toggleTheme);
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.body.dataset.theme = savedTheme;
            document.getElementById('closeReportModal')?.addEventListener('click', closeReportModal);
            document.getElementById('reportErrorModal')?.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal-overlay')) {
                    closeReportModal();
                }
            });
            document.querySelectorAll('.report-option').forEach(button => {
                button.addEventListener('click', (e) => {
                    const errorType = e.currentTarget.dataset.errorType;
                    recordReportError(errorType);
                });
            });
            document.querySelectorAll('.carousel-title').forEach(titleElement => {
                titleElement.addEventListener('click', (e) => {
                    const linkId = e.currentTarget.dataset.linkId;
                    if (linkId && linkId !== 'none') {
                        const catalogUrl = `${CONSTRUCTION_LINK}#catalog-${linkId}`;
                        window.location.href = catalogUrl;
                        showNotification(`Redirecionando para o Catálogo Completo de: ${e.currentTarget.textContent.trim()}`);
                    }
                });
            });
           // ==========================================================
           // ✨ LÓGICA DE CLIQUE PARA CARDS DE DETALHES/RECOMENDAÇÃO
           // ==========================================================
            let clickTimer = null;
            document.querySelectorAll('#saihate-details-carousel .anime-card, #isekai-animes-carousel .anime-card').forEach(card => {
                card.addEventListener('click', (e) => {
                    e.preventDefault();
                    if (clickTimer === null) {
                        clickTimer = setTimeout(() => {
                            clickTimer = null;
                            // Single click: Tenta navegar/notificar (Ação padrão)
                            const url = card.dataset.url;
                            if (url && url.startsWith('javascript:')) {
                                eval(url);
                            } else if (url && url !== "") {
                                window.location.href = url;
                            } else {
                                console.warn("URL do anime não definida:", card.dataset.title);
                            }
                        }, 300); // Tempo para detectar double click
                    } else {
                        clearTimeout(clickTimer);
                        clickTimer = null;
                        // Double click: abre modal de RPG (Personagem)
                        const title = card.dataset.title;
                        const synopsis = card.dataset.synopsis;
                        const image = card.dataset.image;
                        openRpgModal(title, synopsis, image);
                    }
                });
            });
           // ==========================================================
           // ✨ LÓGICA DE CLIQUE PARA CARDS DO CARROSSEL DE EPISÓDIOS
           // ==========================================================
            document.getElementById('episodes-carousel')?.addEventListener('click', (e) => {
                const card = e.target.closest('.anime-card');
                if (!card) return;
                let clickTimer = null;
                // Simular o comportamento de clique duplo para o card de episódio
                if (clickTimer === null) {
                    clickTimer = setTimeout(() => {
                        clickTimer = null;
                        // Single click: Atualiza capa e executa ação normal
                        const url = card.dataset.url;
                        const title = card.dataset.title;
                        const image = card.dataset.image;
                        if (image && title) {
                            // 1. ATUALIZA A CAPA (Hero Section)
                            updateHeroSection(`Saihate no Paladin: ${title}`, image);
                        }
                        if (url && url.startsWith('javascript:')) {
                            // 2. EXECUTA JS (Dispara a notificação, link do player)
                            eval(url);
                        } else if (url && url !== "") {
                            // 3. REDIRECIONA PARA O PLAYER
                            window.location.href = url;
                        } else {
                            showNotification(`Card: ${title} - Link do player não configurado.`, 4000);
                            console.warn("URL do episódio não definida:", title);
                        }
                    }, 300); // Tempo para detectar double click
                } else {
                    clearTimeout(clickTimer);
                    clickTimer = null;
                    // Double click: abre modal de Descrição do Episódio SEM executar ação de single click
                    const title = card.dataset.title;
                    const description = card.dataset.description;
                    const image = card.dataset.image;
                    openEpisodeModal(title, description, image);
                }
            });
            // Listener para fechar o novo modal de detalhes
            document.getElementById('closeDetailsModal')?.addEventListener('click', closeDetailsModal);
            document.getElementById('detailsModal')?.addEventListener('click', (e) => {
                // Fechar se clicar no overlay
                if (e.target.classList.contains('modal-overlay')) {
                    closeDetailsModal();
                }
            });
            // Listener para fechar o novo modal RPG
            document.getElementById('closeRpgModal')?.addEventListener('click', closeRpgModal);
            document.getElementById('rpgModal')?.addEventListener('click', (e) => {
                // Fechar se clicar no overlay
                if (e.target.classList.contains('modal-overlay')) {
                    closeRpgModal();
                }
            });
            // Listener para fechar o novo modal de episódio
            document.getElementById('closeEpisodeModal')?.addEventListener('click', closeEpisodeModal);
            document.getElementById('episodeModal')?.addEventListener('click', (e) => {
                // Fechar se clicar no overlay
                if (e.target.classList.contains('modal-overlay')) {
                    closeEpisodeModal();
                }
            });
            console.log('14. [EVENTOS] Configuração de event listeners concluída.');
        }
        document.addEventListener('DOMContentLoaded', () => {
            console.log('17. [DOM] DOMContentLoaded. Chamando buildHomepage() e setupEventListeners().');
            buildHomepage();
            setupEventListeners();
        });
        window.addEventListener('beforeunload', () => {
            console.log('[LIFECYCLE] Evento beforeunload. Salvando estado...');
            localStorage.setItem('theme', document.body.dataset.theme);
            localStorage.setItem('zoomLevel', (parseFloat(document.documentElement.style.fontSize) / 16 || INITIAL_ZOOM).toFixed(2));
        });
        console.log('18. [FINAL] Script da Homepage carregado.');
    </script>
</body>
</html>
